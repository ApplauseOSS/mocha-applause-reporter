{"version":3,"file":"hooks.mjs","sources":["../src/hooks.ts"],"sourcesContent":["import { Hook, Test } from 'mocha';\nexport const SESSION_ID_EVENT = 'applause-session-id-register';\nexport function registerSessionIdHook(sessionIdLookup) {\n    return function () {\n        if (this.test instanceof Hook &&\n            !this.test.title.startsWith('\"before each\"')) {\n            console.warn('Can only register session id in the beforeEach hook');\n            return;\n        }\n        registerSessionId.apply(this, [sessionIdLookup()]);\n    };\n}\nexport function registerSessionId(sessionId) {\n    // this: Mocha.Context can be executed for either a Hook for a test. If this is being executed for a Hook,\n    // we want to emit the event on the currentTest, not the test (which is actually the hook)\n    if (this.test instanceof Test) {\n        this.test?.emit(SESSION_ID_EVENT, JSON.stringify({ fullTitle: this.test?.fullTitle(), sessionId }));\n    }\n    else if (this.test instanceof Hook && this.currentTest instanceof Test) {\n        this.currentTest?.emit(SESSION_ID_EVENT, JSON.stringify({ fullTitle: this.currentTest?.fullTitle(), sessionId }));\n    }\n}\n//# sourceMappingURL=hooks.js.map"],"names":[],"mappings":";;AACY,MAAC,gBAAgB,GAAG,+BAA+B;AACxD,SAAS,qBAAqB,CAAC,eAAe,EAAE;AACvD,IAAI,OAAO,YAAY;AACvB,QAAQ,IAAI,IAAI,CAAC,IAAI,YAAY,IAAI;AACrC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,eAAe,CAAC,EAAE;AAC1D,YAAY,OAAO,CAAC,IAAI,CAAC,qDAAqD,CAAC,CAAC;AAChF,YAAY,OAAO;AACnB,SAAS;AACT,QAAQ,iBAAiB,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,eAAe,EAAE,CAAC,CAAC,CAAC;AAC3D,KAAK,CAAC;AACN,CAAC;AACM,SAAS,iBAAiB,CAAC,SAAS,EAAE;AAC7C;AACA;AACA,IAAI,IAAI,IAAI,CAAC,IAAI,YAAY,IAAI,EAAE;AACnC,QAAQ,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,SAAS,EAAE,IAAI,CAAC,IAAI,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;AAC5G,KAAK;AACL,SAAS,IAAI,IAAI,CAAC,IAAI,YAAY,IAAI,IAAI,IAAI,CAAC,WAAW,YAAY,IAAI,EAAE;AAC5E,QAAQ,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,SAAS,EAAE,IAAI,CAAC,WAAW,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;AAC1H,KAAK;AACL;;;;"}